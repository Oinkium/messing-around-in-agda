module monoid where

data List (A : Set) : Set where
  emptyList : List A
  append : List A -> (A -> List A)

concatenate : {A : Set} -> (List A -> (List A -> List A))
concatenate L emptyList = L
concatenate L (append M a) = append (concatenate L M) a

_* : {A : Set} -> {B : Set} -> ((A -> B) -> (List A -> List B))
(f *) emptyList = emptyList
(f *) (append L a) = append ((f *) L) (f a)

FreeMonoidSet : Set -> Set
FreeMonoidSet A = List A

MonadAction : {A : Set} -> (FreeMonoidSet (FreeMonoidSet A) -> FreeMonoidSet A)
MonadAction emptyList = emptyList
MonadAction (append M a) = concatenate (MonadAction M) a

PreMonoid : Set -> Set
PreMonoid A = (FreeMonoidSet A) -> A

data _â‰¡_ {X} : X -> (X -> Set) where
  refl : (x : X) -> x â‰¡ x

AssociativityProof : {A : Set} -> PreMonoid A -> Set
AssociativityProof PM = (Î» ğ” -> PM (MonadAction ğ”)) â‰¡ (Î» ğ” -> PM ((PM *) ğ”))

FreeMonoid : (A : Set) -> PreMonoid (FreeMonoidSet A)
FreeMonoid L = MonadAction L

FreeMonoidAssociativity : Set -> AssociativityProof
FreeMonoidAssociativity A = refl (Î» ğ“› -> MonadAction (MonadAction ğ“›)) (Î» ğ“› -> MonadAction ((MonadAction *) ğ“›))


